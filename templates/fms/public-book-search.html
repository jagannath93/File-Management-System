<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <!--link rel="shortcut icon" href="../../assets/ico/favicon.ico"-->

  <title>Manasaram Architects</title>

  <link rel="stylesheet" href="/static/css/jquery-ui.css" type="text/css" media="all"/>
  <link rel="stylesheet" href="/static/css/bootstrap.min.css" type="text/css" /> 
  <link href="/static/css/starter-template.css" rel="stylesheet"> 

  <style type="text/css">
     .container {
      width: 750px;
      margin-left: 350px;
      margin-top: 10px;
      margin-bottom: 50px;
      text-align: center;
    }
    legend {
      text-align: left;
      width: 950px;
      margin-left: -100px;
    }
    .search-bar {
      margin-left: -100px;
    }
    .book-data {
      display: block;
    }
    .book-image {
      padding: 5px;
      padding-top: 10px;
    }
    .book-image img{
      display: block;
      width: 100px;
      float: left;
    }
    .book-table {
      display: block;
      width: 600px;
      float: left;
    }
    .form1 {
      float:left;
      /*margin-left: -100px;*/
    }
    input {
      width: 600px;
      /*margin-top: 10px;*/
    }
    select {
      width: 150px;
    }
    .table1 td {
      width: 100px;
      padding: 10px;
      padding-left: 5px;
    }
    .footer{
      width: 400px;
      text-align: center;
      height: 20px;
      font-weight: bold;
      font-size: 15px;
      margin-left: 120px;
    }
  </style>

  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="/static/js/jquery-ui.js"></script>
  <script type="text/javascript">
  $(document).ready(function() {
    var books = new Array();
    $( ".search-bar" ).autocomplete({
		     source: function(request, response) {
		      $.ajax({
		          url: "/fms/public/book-search/",
		          data: { q: $(".search-bar").val(), filter1: $(".filter1").val(), filter2: $(".filter2").val() },
		          dataType: "json",
		          type: "GET",
		          success: function(data){
                books = data;
                if(books.length != 0)
                {
                  response($.map(data, function(book) {
                    return { 
                      label: book.name+": "+book.isbn,
                      value: book.name,
                      isbn: book.isbn,
                      a_code: book.address.code,
                      a_rack: book.address.rack,
                      a_row: book.address.row,
                      a_shelf_set: book.address.shelf_set,
                      publisher: book.publisher,
                      author: book.author,
                      _status: book.status,
                      id: book.id
                    }
                  }));
                }
                else {
                  $('#main').html('<b>No Items Found.</b>');
                }
		          } 
		        });
         },
		      selectFirst:true,
		      minLength:2,
		      select: function(event,ui) {
           $.ajax({
		          url: "/fms/book-search/book-data/",
		          data: { book_id: ui.item.id },
		          dataType: "json",
		          type: "GET",
              success: function(data){

              var book = data.bdata;
              var address = data.address;
              var _status = (book.name == true) ? '<span style="color:green;"><b>YES<b></style>' : '<span style="color:red;"><b>No</b></style>';
              var _isbn = (book.isbn != 'None') ? book.isbn:"--";
              var _publisher = book.publisher ? book.publisher:"--";
              var _author = book.author ? book.author:"--";
              
              var p_ele = '<div class="book-data">'+
                            '<legend>'+ book.name +'</legend>'+
                            '<table class="entry-table table table-striped table-bordered table-condensed">'+
                              '<tr><td>'+
                            '<div class="book-image">'+
                              '<img src="/'+ book.image +'" alt="cover-image"/>'+
                            '</div>'+
                            '</td>'+
                            '<td>'+
                            '<div class="book-table">'+
                            '<table class="table table-striped table-bordered table-condensed">'+
                              '<tr><td>Name: </td><td>'+book.name+'</td></tr>'+
                              '<tr><td>ISBN Number: </td><td>'+ _isbn +'</td></tr>'+
                              '<tr><td>Publisher: </td><td>'+ _publisher +'</td></tr>'+
                              '<tr><td>Author: </td><td>'+ _author +'</td></tr>'+
                              '<tr><td>Availability: </td><td>'+ _status +'</td></tr>'+
                          '</table>'+
                          '</div></td></tr></table>'+
                        '</div><br>';                 
              $('#main').html(p_ele);
           }
        });

        $(this).val('');
		  }

    });
  });
  </script>
</head>
<body>
  <div class="container">
    <h3>BOOK SEARCH</h3>
    <h4>LIBRARY MANAGEMENT SYSTEM</h3><br>
    <div id="msg">{{page_msg}}</div><br>
    <legend>Search Books</legend>
    <form class="form1" action="#">
      <table class="table1" cellspacing="0" cellpadding="0">
        <tr>
          <td class="search">
            <input type="text" class="search-bar" name="q" PLACEHOLDER="Search books..."/>
          </td>
          <td>
            <select class="filter1">
              <option value="">Search by</option>
              <option value="name">Name</option>
              <option value="author">Author</option>
              <option value="publisher">Publisher</option>
              <option value="isbn_number">Isbn Number</option>
            </select>
          </td>
          <td>
            <select class="filter2">
              <option value=''>Category</option>
              <option value='Landscape'>Landscape</option>
              <option value='Interiors'>Interiors</option>
              <option value='Materials'>Materials</option>
              <option value='CGBMT'>CGBMT</option>
              <option value='Manasaram'>Manasaram</option>
              <option value='Bamboo-Technology'>Bamboo Technology</option>
              <option value='Construction'>Construction</option>
              <option value='Reference'>Reference</option>
            </select>
          </td>
        </tr>
      </table>
    </form>
    <div id="main"></div>
    <br><br><br>
    <div class="footer">Copyright Â© 2014 by Manasaram Architects</div>
  </div>
</body>
</html>

